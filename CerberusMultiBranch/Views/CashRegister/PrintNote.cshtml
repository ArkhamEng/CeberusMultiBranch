@model CerberusMultiBranch.Models.Entities.Operative.Sale
@{
    ViewBag.Title = "SaleDetail";
}

<script src="~/Scripts/printThis.js"></script>

<h3>
    <span class="fa fa-ticket" style="float:left"></span>
    &nbsp;&nbsp;Nota de venta
</h3>
<h4 class="text-danger">
   Vendedor: @Model.User.UserName
</h4>

<hr />
<div id="divPrint" >
    <div class="row">
        <div class="col-xs-6 col-md-5">
            <div class="col-xs-6  col-md-5">
                <img src="~/Content/Images/logo2.png" class="img-responsive" >
            </div>
            <div class="col-xs-12   col-md-12">
                <h5 class="media-heading"><label class="control-label">Autopartes Bicentenario S.A. de C.V.</label></h5>
                <p class="small">  RFC: APB 1000811 4Q4 <br />AV DE LA MANCHA 568 INT. 11-B<br />LOMAS DE ZAPOPAN 45130 <br />ZAPOPAN JAL MX</p>
            </div>
        </div>

        <div class="col-xs-5 col-xs-offset-1 col-md-offset-3 col-md-4">
            <div class="panel panel-danger">
                <div class="text-center BkPrint">
                    Datos de Compra
                </div>
                <table class="table table-bordered panel-body">
                    <tr>
                        <td colspan="2"><label class="control-label">Fecha de venta:</label> </td>
                        <td colspan="2">@Model.TransactionDate.ToString("dd/MM/yyyy HH:mm")</td>
                    </tr>
                    <tr>
                        <td><label class="control-label">Folio:</label></td>
                        <td>@Model.Folio</td>
                        <td><label class="control-label">Pago:</label></td>
                        <td>@Model.PaymentType.ToString()</td>
                    </tr>
                </table>
            </div>
        </div>
    </div>

    <div class="row ">
        <div class="col-xs-12">
            <div class="panel panel-danger">
                <div class="BkPrint text-center">
                    Datos del cliente
                </div>
                <table class="table table-bordered">
                    <tbody>
                        <tr>
                            <td>
                                <label class="control-label">
                                    @Html.DisplayName("Nombre")
                                </label>
                            </td>
                            <td>@Html.DisplayFor(m => Model.Client.Name)</td>

                            <td>
                                <label class="control-label">
                                    @Html.DisplayName("RFC")
                                </label>
                            </td>
                            <td>@Html.DisplayFor(m => Model.Client.FTR)</td>
                        </tr>
                        <tr></tr>
                        <tr>
                            <td>
                                <label class="control-label">
                                    @Html.DisplayName("Dirección")
                                </label>
                            </td>
                            <td colspan="3">@Html.DisplayFor(m => Model.Client.TaxAddress)</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="row ">
        <div class="col-xs-12">
            <div class="panel panel-danger">
                <div class="col-xs-2 col-md-1  text-center BkPrint">@Html.DisplayName("Clave")</div>
                <div class="col-xs-1 col-md-1  text-center BkPrint">@Html.DisplayName("Cant")</div>
                <div class="col-xs-5 col-md-6  text-center BkPrint">@Html.DisplayName("Descripción")</div>
                <div class="col-xs-2 col-md-2  text-center BkPrint">@Html.DisplayName("Precio")</div>
                <div class="col-xs-2 col-md-2  text-center BkPrint">@Html.DisplayName("Importe")</div>
                <table class="table table-bordered">
                    <tbody class="panel-body">
                        @foreach (var item in Model.TransactionDetails)
                    {
                            <tr>
                                <td class="col-xs-2 col-md-1 text-center">
                                    @Html.DisplayFor(mItem => item.Product.Code)
                                </td>
                                <td class="col-xs-1 col-md-1 text-center">
                                    @Html.DisplayFor(mItem => item.Quantity)
                                </td>
                                <td class="col-xs-5 col-md-6">
                                    @Html.DisplayFor(mItem => item.Product.Name)
                                </td>
                                <td class="col-xs-2 col-md-2  text-right">
                                    @Html.DisplayFor(mItem => item.Price)
                                </td>
                                <td class="col-xs-2 col-md-2 text-right">
                                    @Html.DisplayFor(mItem => item.Amount)
                                </td>
                            </tr>
                    }
                    </tbody>
                    <tfoot>
                        <tr>
                            <td colspan="3"></td>
                            @{
                            var bI = Math.Round(Model.TotalAmount / 1.16, 2);
                            var iva = Math.Round(Model.TotalAmount - bI, 2);
                            }
                            <td class="text-right alert alert-info">
                                <label class="control-label">
                                    @Html.DisplayName("Sub-Total")
                                </label>
                            </td>
                            <td class="text-right">@bI.ToString("c") </td>
                        </tr>
                        <tr>
                            <td colspan="3"></td>
                            <td class="text-right alert alert-danger">
                                <label class="control-label">
                                    @Html.DisplayName("IVA")
                                </label>
                            </td>
                            <td class="text-right">@iva.ToString("c") </td>
                        </tr>
                        <tr>
                            <td colspan="3"></td>
                            <td class="text-right alert alert-info">
                                <label class="control-label">
                                    @Html.DisplayName("Total")
                                </label>
                            </td>
                            <td class="text-right"><label class="control-label text-danger">@Model.TotalAmount.ToString("c")</label> </td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>
    </div>
</div>



<div class="btn-group">
    <button class="btn btn-primary" type="button" onclick="window.location='@Url.Action("Index")'">
        <span class="fa fa-search"></span>
        Buscar
    </button>
    <button class="btn btn-success" type="button" id="btnPrint">
        <span class="fa fa-print"></span>
        Imprimir
    </button>
</div>


<script>
    $(document).ready(function ()
    {
        $("#btnPrint").click(function () 
        {
            $("#divPrint").printThis(
                {
                    footer:  "<h1>Amazing header</h1>"
            });
          
        });
    });


</script>