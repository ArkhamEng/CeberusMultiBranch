
@model ICollection<CerberusMultiBranch.Models.Entities.Operative.Sale>
@using CerberusMultiBranch.Models.Entities.Operative
@using CerberusMultiBranch.Support

<div class="panel panel-danger">
    <div class="panel-heading">
        <h4 class="panel-title text-uppercase">
            <span class="fa fa-eye-slash" style="float:left">
            </span>
            &nbsp;Devoluciones pendientes
        </h4>
    </div>
    <div class="panel-body">
        <table id="tbPendingPayment" class="table table-bordered small">
            <thead>
                <tr>
                    <th class="col-md-1 text-center">@Html.DisplayName("Folio")</th>
                    <th class="col-md-5 text-center">@Html.DisplayName("Cliente")</th>

                    <th class="col-md-2 text-center">@Html.DisplayName("En efectivo")</th>
                    <th class="col-md-2 text-center">@Html.DisplayName("En vale")</th>
                    <th class="col-md-2 text-center">@Html.DisplayName("Cancelo")</th>
                    <th class="col-md-1 text-center">@Html.DisplayName("Tipo")</th>
                    <th class="col-md-1 text-center" />
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)
                {
                    <tr>
                        <td  class="text-uppercase">@Html.DisplayFor(m => item.Folio)</td>
                        <td  class="text-uppercase">@Html.DisplayFor(m => item.Client.Name)</td>

                        <td align="center">
                        @item.SalePayments.Where(s=> s.PaymentMethod == PaymentMethod.Efectivo).Sum(s=> s.Amount).ToMoney()
                        </td>

                        <td align="center">
                        @item.SalePayments.Where(s => s.PaymentMethod != PaymentMethod.Efectivo).Sum(s => s.Amount).ToMoney()
                        </td>

                        <td align="center">@Html.DisplayFor(m => item.UpdUser)</td>

                        <td align="center">
                            @{
                                var alr = "alert-success";

                                switch (item.TransactionType)
                                {
                                    case CerberusMultiBranch.Models.Entities.Operative.TransactionType.Credito:
                                        alr = "alert-danger";
                                        break;
                                    case CerberusMultiBranch.Models.Entities.Operative.TransactionType.Preventa:
                                        alr = "alert-info";
                                        break;
                                    case CerberusMultiBranch.Models.Entities.Operative.TransactionType.Apartado:
                                        alr = "alert-warning";
                                        break;
                                }
                            }
                            <div class="form-control input-sm @alr">
                                @item.TransactionType.ToString()
                            </div>
                        </td>
                        <td align="center">
                            <button class="btn btn-danger" title="Generar devoluciones" onclick="ShowRefundmentModal('@item.SaleId')">
                                <span class="fa fa-exchange" />
                            </button>
                        </td>
                    </tr>
               }
            </tbody>
        </table>
    </div>
</div>
