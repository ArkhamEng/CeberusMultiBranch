@model PurchaseCartViewModel
@using CerberusMultiBranch.Models.Entities.Operative
@using CerberusMultiBranch.Models.ViewModels.Operative
@using CerberusMultiBranch.Support
@{
    ViewBag.Title = "Orden de compra";
    ViewBag.Class = "fa fa-shopping-basket";
}

@Scripts.Render("~/bundles/jqueryval")


@Html.AntiForgeryToken()
@Html.ValidationSummary(true, "", new { @class = "text-danger" })

@Html.HiddenFor(model => model.ProviderId)


<br />


<div class="panel panel-default">
    <div class="panel-body small">

        @Html.HiddenFor(m => m.ProviderId)

        <div class="form-group col-md-7">
            @Html.LabelFor(m => m.ProviderName, htmlAttributes: new { @class = "control-label" })
            <div class="input-group">
                <span class="input-group-addon"><i class="fa fa-user"></i></span>
                @Html.EditorFor(model => model.ProviderName, new { htmlAttributes = new { @class = "form-control text-uppercase input-sm", autocomplete = "off", @readonly = true } })
                @Html.ValidationMessageFor(model => model.ProviderId, "", new { @class = "text-danger" })
                <span class="input-group-btn">
                    <button class="btn btn-default btn-sm" type="button" title="Buscar proveedores" onclick="ShowProviderQuickSearch()">
                        <span class="glyphicon glyphicon-search"></span>
                    </button>
                </span>
            </div>
        </div>

        <div class="form-group col-md-4 col-md-offset-1">
            @Html.LabelFor(m => m.PuschaseType, htmlAttributes: new { @class = "control-label" })
            <div class="input-group">
                <span class="input-group-addon"><i class="fa fa-map"></i></span>
                @Html.DropDownListFor(model => model.PuschaseType,Model.PurchaseTypes, htmlAttributes: new { @class = "form-control text-uppercase input-sm" })
            </div>
        </div>

    </div>
    <div class="panel-footer clearfix">
        <div class="pull-right">
          
            <button class="btn btn-primary btn-sm" type="button" title="Generar las ordenes de compra">
                <span class="fa fa-check"></span>
                Generar Ordenes
            </button>
            <button class="btn btn-danger btn-sm" type="button" title="Elimina todos los productos">
                <span class="fa fa-times"></span>
                Cancelar
            </button>

        </div>
    </div>
</div>

<div class="panel panel-default">
    <div id="divPurchaseDetails" class="panel-body  dtContainer">
       @Html.Partial("_PurchaseCartDetail",Model.PurchaseItems)
    </div>
</div>


<script>
    function ShowProviderQuickSearch()
    {

        ShowQuickSearch('@Url.Action("ShowQuickSearch", "Providers", new { type = Cons.One  })', function (id, name, ftr)
        {
            $("#ProviderId").val(id);
            $("#ProviderName").val(name);
        });
    }
</script>